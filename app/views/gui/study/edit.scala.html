@(loggedInUser: User, breadcrumbs: String,
submitAction: play.api.mvc.Call, form: Form[Study], studyIsLocked: Boolean)

@views.html.gui.main(loggedInUser, breadcrumbs){

@helper.form(action = submitAction, 'class -> "form-horizontal", 'role -> "form") {

<div class="form-group">
	<div class="col-xs-2"><p class="text-right"><strong>ID</strong>&nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Unique within this JATOS instance" aria-hidden="true"></span></p></div>
	<div class="col-xs-10">
		<p>@if(form(Study.ID).value != null) {@form(Study.ID).value} else {-}</p>
	</div>
</div>

<div class="form-group">
	<div class="col-xs-2"><p class="text-right"><strong>UUID</strong>&nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Universally unique identifier - used to keep track of studies between different JATOS instances" aria-hidden="true"></span></p></div>
	<div class="col-xs-10">
		<p>@if(form(Study.UUID).value != null) {@form(Study.UUID).value} else {-}</p>
	</div>
</div>

<div class="form-group">
	<label class="control-label col-xs-2" for="title">Title</label>
	<div class="col-xs-10">
		<input type="text" class="form-control" id="title" name="@Study.TITLE" value="@form(Study.TITLE).value" placeholder="Your title">
	</div>
</div>

<div class="form-group">
	<label class="control-label col-xs-2" for="description">Description&nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Explain what your study is doing. In case you want to use the Mechanical Turk, this description will be shown to the participants." aria-hidden="true"></span></label>
	<div class="col-xs-10">
		<textarea rows="3" class="form-control" id="description" name="@Study.DESCRIPTION" placeholder="Your description">@form(Study.DESCRIPTION).value</textarea>
	</div>
</div>

<div class="form-group">
	<label class="control-label col-xs-2" for="dirName">Study assets' directory name&nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Enter the name of the directory of your study assets in the file system of the JATOS server. All HTML, JavaScript, CSS, and images goes in there." aria-hidden="true"></span></label>
	<div class="col-xs-10">
		<input type="text" class="form-control" id="dirName" name="@Study.DIRNAME" value="@form(Study.DIRNAME).value" placeholder="Study assets' directory name">
	</div>
</div>

<div class="form-group">
	<label class="control-label col-xs-2" for="comments">Comments&nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Something you want to share or just don't want to forget?" aria-hidden="true"></span></label>
	<div class="col-xs-10">
		<textarea rows="3" class="form-control" id="comments" name="@Study.COMMENTS" placeholder="Your comments">@form(Study.COMMENTS).value</textarea>
	</div>
</div>

<div class="form-group">
	<label class="control-label col-xs-2" for="jsonData">JSON input&nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Your component scripts can ask for this input data. If you need a larger field you can increase the size with the button in the bottom-right corner. You can also leave it empty if not needed." aria-hidden="true"></span></label>
	<div class="col-xs-10">
		<textarea rows="6" class="form-control" id="jsonData" name="@Study.JSON_DATA" placeholder="Put your JSON string here">@utils.JsonUtils.makePretty(form(Study.JSON_DATA).value)</textarea>
	</div>
</div>

<div class="form-group">
	<label class="control-label col-xs-2" for="allowedWorkerTypes">Group study&nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Make this study a group study with several workers working together in a group." aria-hidden="true"></span></label>
	<div class="col-xs-10">
		<label class="checkbox-inline" for="groupStudy">
			<input type="checkbox" name="@Study.GROUP_STUDY" id="groupStudy" value="true"
					@if("true".equals(form(Study.GROUP_STUDY).value)) {checked="checked"}
					>&nbsp;<!-- Don't remove this space! It's needed for checkbox-inline. -->
			<!-- We need a hidden input field.
			http://stackoverflow.com/questions/8204708/how-do-i-bind-a-checkbox-to-a-boolean-in-play-framework -->
			<input type="hidden" name="@Study.GROUP_STUDY" value="false" />
		</label>
	</div>
</div>

<div id="minMemberSizeDiv" class="form-group">
	<label class="control-label col-xs-2" for="minMemberSize">Minimum member size &nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Enter the minimal number of members who can be in a group at the same time." aria-hidden="true"></span></label>
	<div class="col-xs-2">
		<input type="number" class="form-control" id="minMemberSize" name="@Group.MIN_MEMBER_SIZE" value="@form(Group.MIN_MEMBER_SIZE).value" min="2" placeholder="2">
	</div>
</div>

<div id="maxMemberSizeDiv" class="form-group">
	<label class="control-label col-xs-2" for="maxMemberSize">Maximum member size &nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Enter the maximal number of members who can be in a group at the same time." aria-hidden="true"></span></label>
	<div class="col-xs-2">
		<input type="number" class="form-control" id="maxMemberSize" name="@Group.MAX_MEMBER_SIZE" value="@form(Group.MAX_MEMBER_SIZE).value" min="2" placeholder="2">
	</div>
</div>

<div id="maxWorkerSizeDiv" class="form-group">
	<label class="control-label col-xs-2" for="maxWorkerSize">Maximum worker size &nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Enter the maximal number of workers who can be in the group altogether (not necessarily at the same time)." aria-hidden="true"></span></label>
	<div class="col-xs-2">
		<input type="number" class="form-control" id="maxWorkerSize" name="@Group.MAX_WORKER_SIZE" value="@form(Group.MAX_WORKER_SIZE).value" min="2" placeholder="2">
	</div>
</div>

<div class="form-group">
	<label class="control-label col-xs-2" for="allowedWorkerTypes">Allowed worker types&nbsp;<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Which worker types are allowed to run this study?" aria-hidden="true"></span></label>
	<div class="col-xs-10" id="allowedWorkerTypes">
		<label class="checkbox-inline">
			<input type="checkbox" name="@Study.ALLOWED_WORKER_LIST" value="@workers.JatosWorker.WORKER_TYPE"
					@if(form(Study.ALLOWED_WORKER_LIST).value != null && form(Study.ALLOWED_WORKER_LIST).value.contains(workers.JatosWorker.WORKER_TYPE)) {checked}
					>@workers.JatosWorker.UI_WORKER_TYPE
					<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Used for runs started with study's or component's 'run' button. Jatos workers can run any study as many times as they want." aria-hidden="true"></span>
		</label>
		<label class="checkbox-inline">
			<input type="checkbox" name="@Study.ALLOWED_WORKER_LIST" value="@workers.PersonalMultipleWorker.WORKER_TYPE"
					@if(form(Study.ALLOWED_WORKER_LIST).value != null && form(Study.ALLOWED_WORKER_LIST).value.contains(workers.PersonalMultipleWorker.WORKER_TYPE)) {checked}
					>@workers.PersonalMultipleWorker.UI_WORKER_TYPE
					<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title=" Creates a link to a run that can be used multiple times and always assigns the results to the same JATOS worker. Typically used to distribute amongst your pilot workers. Each link is personalized, i.e., you provide an ID (some pseudonym or ID) when creating it." aria-hidden="true"></span>
		</label>
		<label class="checkbox-inline">
			<input type="checkbox" name="@Study.ALLOWED_WORKER_LIST" value="@workers.PersonalSingleWorker.WORKER_TYPE"
					@if(form(Study.ALLOWED_WORKER_LIST).value != null && form(Study.ALLOWED_WORKER_LIST).value.contains(workers.PersonalSingleWorker.WORKER_TYPE)) {checked}
					>@workers.PersonalSingleWorker.UI_WORKER_TYPE
					<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Creates a link to a run that can be used only once and always assigns the results to the same JATOS worker. Typically used to distribute amongst workers that you contact individually. Each link is personalized, i.e., you provide an ID (some pseudonym or ID) when creating it." aria-hidden="true"></span>
		</label>
		<label class="checkbox-inline">
			<input type="checkbox" name="@Study.ALLOWED_WORKER_LIST" value="@workers.GeneralSingleWorker.WORKER_TYPE"
					@if(form(Study.ALLOWED_WORKER_LIST).value != null && form(Study.ALLOWED_WORKER_LIST).value.contains(workers.GeneralSingleWorker.WORKER_TYPE)) {checked}
					>@workers.GeneralSingleWorker.UI_WORKER_TYPE
					<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="Creates a link to a run that can be used only once and creates a new JATOS worker with each run. Typically used to distribute in a mailing list or posting it in a public website." aria-hidden="true"></span>
		</label>
		<label class="checkbox-inline">
			<input type="checkbox" name="@Study.ALLOWED_WORKER_LIST" value="@workers.MTWorker.WORKER_TYPE"
					@if(form(Study.ALLOWED_WORKER_LIST).value != null && form(Study.ALLOWED_WORKER_LIST).value.contains(workers.MTWorker.WORKER_TYPE)) {checked}
					>@workers.MTWorker.UI_WORKER_TYPE
					<span class="glyphicon glyphicon-info-sign gray-light" data-toggle="tooltip" title="MTurk workers access a study through Amazon's Mechanical Turk. MTurk workers can access a study only once." aria-hidden="true"></span>
		</label>
	</div>
</div>

<div class="form-group">
	<div class="col-xs-offset-2 col-xs-10">
		<input type="submit" class="btn btn-primary" value="Submit">
	</div>
</div>

}

<script>

window.onload = showGroupSettings;

function showGroupSettings() {
	if ($('#groupStudy').is(':checked')) {
		$('#minMemberSizeDiv').show();
		$('#maxMemberSizeDiv').show();
		$('#maxWorkerSizeDiv').show();
	} else {
		$('#minMemberSizeDiv').hide();
		$('#maxMemberSizeDiv').hide();
		$('#maxWorkerSizeDiv').hide();
	}
}

$('#groupStudy').change(showGroupSettings);

@if(form(Study.ID).value != null) {
	var studyId = @form(Study.ID).value;
}

@if(form.hasErrors) {
	showWarning("@utils.MessagesStrings.STUDY_WASNT_SAVED");
}
@for(error <- form.globalErrors) {
	showError("@error.message");
}
@for(error <- form(Study.TITLE).errors) {
	$('#title').closest(".form-group").addClass("has-error");
	$('#title').after('<span class="help-block">@error.message</span>');
}
@for(error <- form(Study.DESCRIPTION).errors) {
	$('#description').closest(".form-group").addClass("has-error");
	$('#description').after('<span class="help-block">@error.message</span>');
}
@for(error <- form(Study.DIRNAME).errors) {
	$('#dirName').closest(".form-group").addClass("has-error");
	$('#dirName').after('<span class="help-block">@error.message</span>');
}
@for(error <- form(Study.COMMENTS).errors) {
	$('#comments').closest(".form-group").addClass("has-error");
	$('#comments').after('<span class="help-block">@error.message</span>');
}
@for(error <- form(Study.JSON_DATA).errors) {
	$('#jsonData').closest(".form-group").addClass("has-error");
	$('#jsonData').after('<span class="help-block">@error.message</span>');
}
@for(error <- form(Group.MIN_MEMBER_SIZE).errors) {
	$('#minMemberSize').closest(".form-group").addClass("has-error");
	$('#minMemberSize').after('<span class="help-block">@error.message</span>');
}
@for(error <- form(Group.MAX_MEMBER_SIZE).errors) {
	$('#maxMemberSize').closest(".form-group").addClass("has-error");
	$('#maxMemberSize').after('<span class="help-block">@error.message</span>');
}
@for(error <- form(Group.MAX_WORKER_SIZE).errors) {
	$('#maxWorkerSize').closest(".form-group").addClass("has-error");
	$('#maxWorkerSize').after('<span class="help-block">@error.message</span>');
}
@if(studyIsLocked) {
	$(':input').attr("disabled", true);
}
</script>

}
